<!doctype html>
<html lang="en" dir="ltr" class="plugin-docs plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Apache Spark Cluster Configuration Options | TDspora</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:image" content="https://raw.githubusercontent.com/tdspora/tdspora.github.io/main/img/logo-icon-open-graph.png"><meta data-rh="true" property="og:title" content="Apache Spark Cluster Configuration Options | TDspora"><meta data-rh="true" name="description" content="The TDspora application is supplied with a pre-configured Apache Spark cluster running within Docker containers. This cluster is referenced as the &quot;Local cluster&quot; and configured to work in the standalone mode. It has two workers."><meta data-rh="true" property="og:description" content="The TDspora application is supplied with a pre-configured Apache Spark cluster running within Docker containers. This cluster is referenced as the &quot;Local cluster&quot; and configured to work in the standalone mode. It has two workers."><meta data-rh="true" property="og:url" content="https://tdspora.github.io/docs/config/clusters/spark-submit-options"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="alternate" href="https://tdspora.github.io/docs/config/clusters/spark-submit-options" hreflang="en"><link data-rh="true" rel="alternate" href="https://tdspora.github.io/docs/config/clusters/spark-submit-options" hreflang="x-default"><link data-rh="true" rel="alternate" href="https://tdspora.ai//docs/config/clusters/spark-submit-options"><link data-rh="true" rel="alternate" href="https://tdspora.ai//docs/config/clusters/spark-submit-options"><link data-rh="true" rel="canonical" href="https://tdspora.ai//docs/config/clusters/spark-submit-options"><script src="https://tdspora.ai/scripts/scriptAtlassian1.js" defer="defer" data-key="a2de66ac-0fd7-4bd8-85c9-f3760fccc23e" data-jsd-embedded="" data-base-url="https://jsd-widget.atlassian.com"></script>
<script src="https://cookie-cdn.cookiepro.com/consent/9328ef5a-5e60-4408-834c-12a014609889/OtAutoBlock.js" defer="defer"></script>
<script src="https://cookie-cdn.cookiepro.com/scripttemplates/otSDKStub.js" defer="defer" charset="UTF-8" data-domain-script="9328ef5a-5e60-4408-834c-12a014609889"></script>
<script src="data:text/javascript;base64,ZnVuY3Rpb24gT3B0YW5vbldyYXBwZXIoKSB7IH0" defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.2e92c066.css">
<link rel="preload" href="/assets/js/runtime~main.9a2d847a.js" as="script">
<link rel="preload" href="/assets/js/main.2abae0fa.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><header class="fixed top-0 inset-x-0 z-50 h-nav header_DiDm"><div class="absolute top-0 left-0 z-40 w-full shadow-navBar"><nav class="flex items-center justify-between h-nav navigationContainer"><a href="/"><img src="/img/logo.svg" alt="logo"></a><div class="lg:flex items-center"><ul class="invisible lg:visible fixed lg:static flex flex-row gap-6 items-center"><li><a style="text-decoration:none" class="flex items-center h-22 text-16 text-monochrome-default tab_hkiA" href="/features">Features</a></li><li><a style="text-decoration:none" class="flex items-center h-22 text-16 text-monochrome-default tab_hkiA" href="/plans">Plans</a></li><li><a style="text-decoration:none" class="flex items-center h-22 text-16 text-monochrome-default activeTab_WWS9" href="/docs/introduction">Docs</a></li><li><a style="text-decoration:none" class="flex items-center h-22 text-16 text-monochrome-default tab_hkiA" href="/contact">Contact us</a></li><li><a href="https://github.com/tdspora/syngen" target="_blank" rel="noopener noreferrer" class="githubLink_dud9"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path clip-rule="evenodd" d="M11.999 0C5.373 0 0 5.509 0 12.304 0 17.74 3.438 22.351 8.207 23.98c.6.113.819-.267.819-.594 0-.292-.01-1.066-.017-2.092-3.337.743-4.042-1.65-4.042-1.65-.545-1.421-1.332-1.8-1.332-1.8-1.09-.762.082-.747.082-.747 1.205.087 1.838 1.268 1.838 1.268 1.07 1.88 2.81 1.337 3.493 1.022.109-.795.419-1.337.762-1.644-2.665-.312-5.467-1.367-5.467-6.081 0-1.344.468-2.442 1.236-3.302-.124-.311-.536-1.562.118-3.256 0 0 1.007-.33 3.3 1.26A11.258 11.258 0 0 1 12 5.95a11.27 11.27 0 0 1 3.005.414c2.29-1.592 3.296-1.261 3.296-1.261.655 1.694.243 2.945.12 3.256.77.86 1.233 1.958 1.233 3.302 0 4.726-2.806 5.766-5.478 6.07.43.38.814 1.131.814 2.28 0 1.644-.015 2.97-.015 3.374 0 .33.217.712.825.592 4.765-1.63 8.2-6.238 8.2-11.673C24 5.51 18.627 0 11.999 0z"></path></svg><div class="githubStarsCount_ehdJ"><span class="text-monochrome-text font-regular">+<!-- -->0</span></div></a></li><li><a style="text-decoration:none" class="button-primary ml-5 px-8" href="/contact">Request demo</a></li></ul><button aria-label="menu button" class="flex items-center justify-center w-9 h-9 lg:hidden text-monochrome-black fill-current bg-menu bg-no-repeat" type="button"></button></div></nav></div></header><div class="main-wrapper mainWrapper_z2l0"><div class="docPageContainer_vFwC"><div class="background_rNR4"></div><div class="flex flex-col lg:pt-6 lg:pl-6 lg:border-r border-none" role="complementary"><button aria-label="Open Menu" aria-haspopup="true" class="button--documentation-menu-open" type="button"><span style="background-image:url(/img/documentation-menu.svg);min-width:24px;min-height:24px;display:inline-block"></span><div>Documentation menu</div></button><div class="search-bar-icon"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div><div id="searchLoupe"></div></div><div class="menu px-6 lg:px-0"></div></div><main class="grid grid-cols-12 gap-x-5 mb-22"><article class="col-span-12 lg:col-start-2 lg:col-span-8 mt-30 lg:mt-1" style="max-width:100%"><header><h1 class="mt-8 mb-4 text-44 font-ubuntu leading-48 text-monochrome-text">Apache Spark Cluster Configuration Options</h1></header><div class="markdown"><p>The TDspora application is supplied with a pre-configured Apache Spark cluster running within Docker containers. This cluster is referenced as the &quot;Local cluster&quot; and configured to work in the <code>standalone</code> mode. It has two workers.</p><p>Please note that the Local cluster is intended for testing and demonstration purposes only. It is not recommended to use the cluster to process a large amount of data or execute more than one Spark application simultaneously.
You can change its default configuration by using the <strong>Spark-submit options</strong> field in the <strong>Advanced section</strong>.
Please ensure that the TDspora server has enough resources to allow the Local cluster to process Spark applications without significant degradation in performance of the server itself.</p><p>The production scale jobs require distributed Spark cluster configured to handle workloads corresponding to the data volumes extracted from the production databases. For example, the subsetting of 20GB of data from an Oracle database requires roughly 6GB RAM on a worker node.
You also can use the <strong>Spark-submit options</strong> field in the <strong>Advanced</strong> section to manage the cluster resources (CPU cores and memory) for running your pipelines.</p><p>See <a href="https://spark.apache.org/docs/latest/configuration.html#dynamically-loading-spark-properties" target="_blank" rel="noopener noreferrer">Apache Spark configuration</a> and <a href="https://spark.apache.org/docs/latest/job-scheduling.html#graceful-decommission-of-executors" target="_blank" rel="noopener noreferrer">Dynamic Resource Allocation</a> for additional information about Spark configuration and available Spark properties.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploment-mode">Deploment Mode<a class="hash-link" href="#deploment-mode" title="Direct link to heading">​</a></h2><p>The <code>cluster</code> deploy mode set by default for the Apache Spark cluster supplied with the product. You can change the mode by providing option <code>--deploy-mode</code> in the advanced parameters of the cluster configuration. Currently, Spark supports two modes <code>client</code> and <code>cluster</code>.</p><p>Note, that if you set Master URL as <code>local</code> (or any variation of <code>local</code>, see <a href="/docs/config/clusters/spark-master-url">Apache Spark Master URL</a>), the deploy mode will be automatically set to <code>client</code> as with this Master URLs the <code>cluster</code> deploy mode is not supported. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="spark-submit-options">Spark-submit options<a class="hash-link" href="#spark-submit-options" title="Direct link to heading">​</a></h2><p>The options you define in this control passed directly to the spark-submit command that executes pipeline job on a Spark cluster except the following</p><ul><li><code>--class</code> - points to the application engine implementation class <code>com.epam.tdm.engine.TdmEngineJobApp</code></li><li><code>--files</code> - includes files required to execute the job (pipeline)</li><li><code>--master</code> - the master URL specified in a separate input control</li></ul><p>Please refer to the <a href="https://spark.apache.org/docs/latest/configuration.html#application-properties" target="_blank" rel="noopener noreferrer">Apache Spark documentation</a> for additional options available for the driver and executors.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="temporal-tables-created-by-a-pipeline">Temporal tables created by a pipeline<a class="hash-link" href="#temporal-tables-created-by-a-pipeline" title="Direct link to heading">​</a></h3><p>Normally, all temporal tables dropped from the source and target locations, but you can specify additional configuration parameter of the Spark driver using <code>--conf &#x27;spark.driver.extraJavaOptions=-Dtdspora.drop.temp.tables=&lt;MODE&gt;&#x27;</code>as the following</p><table><thead><tr><th>Mode</th><th>Effect</th></tr></thead><tbody><tr><td>ALL</td><td>Drop all temporal tables. Default.</td></tr><tr><td>SOURCE</td><td>Drop all temporal tables from the source.</td></tr><tr><td>TARGET</td><td>Drop all temporal tables from the target.</td></tr><tr><td>NONE</td><td>Do not drop any tables which created by programm.</td></tr></tbody></table><p>For example,</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">--conf &#x27;spark.driver.extraJavaOptions=-Dtdspora.drop.temp.tables=NONE&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-a-pipeline-on-a-remote-cluster">Running a Pipeline on a Remote Cluster<a class="hash-link" href="#running-a-pipeline-on-a-remote-cluster" title="Direct link to heading">​</a></h2><p>When you execute a pipeline, the application connects to the corresponding Apache Spark cluster using SSH and runs the spark-submit command. You can adjust the location and parameters of the command in the <strong>Advanced</strong> cluster configuration section:
<img loading="lazy" alt="Advanced Cluster Configuration Options" src="/assets/images/advanced-cluster-config-211490b4b377faccecc5e6399e3e7d94.png" width="1171" height="485" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ssh-session-and-environment-variables">SSH Session and Environment Variables<a class="hash-link" href="#ssh-session-and-environment-variables" title="Direct link to heading">​</a></h3><p>Under the hood, the application connects to the cluster host in the non-interactive mode. It applied limitations to the availability of the user-defined environment variables.</p><p>We recommend modifying the <code>PATH</code> variable in the <code>/etc/environment</code> file to include Apache Spark <code>bin</code> and <code>sbin</code> folders, for example <code>PATH=...:/opt/spark/bin:/opt/spark/sbin</code>. Also, add the <code>SPARK_HOME</code> variable there. For instance, append line <code>SPARK_HOME=/opt/spark</code> to the file.</p><p>In case you have no privileges to modify the <code>/etc/environment</code> file, you can define the location of the Apache Spark home in the <strong>Advanced</strong> section.</p><ul><li><a href="https://stackoverflow.com/questions/216202/why-does-an-ssh-remote-command-get-fewer-environment-variables-then-when-run-man" target="_blank" rel="noopener noreferrer">Why does an SSH remote command get fewer environment variables then when run manually?</a></li><li><a href="http://www.fabfile.org/faq.html#the-remote-shell-environment-doesn-t-match-interactive-shells" target="_blank" rel="noopener noreferrer">The remote shell environment doesn’t match interactive shells!</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="spark-home">Spark Home<a class="hash-link" href="#spark-home" title="Direct link to heading">​</a></h3><p>The <code>SPARK_HOME</code> environment variable controls the location of the Apache Spark scripts executed even if you use the full path to the script or overrides it in the Cluster configuration. Pre-defined <code>SPARK_HOME</code> takes precedence over any other means of Apache Spark home selection.</p><p>If you have several versions of Spark on the remote machine make sure that the <code>SPARK_HOME</code> variable point to the valid version of Apache Spark.</p><p>Check <a href="/docs/config/clusters/cluster-connection-envs">Cluster connection environment variables</a> for details.</p><hr><p>For more details please check original <a href="https://spark.apache.org/" target="_blank" rel="noopener noreferrer">Apache Spark</a> documentation: <a href="https://spark.apache.org/docs/latest/submitting-applications.html" target="_blank" rel="noopener noreferrer">Submitting Applications</a>.</p></div></article></main></div></div><footer class="bg-monochrome-Gray100 border-monochrome-medium-tint"><div class="fotterContainer_aN_H"><section class="mainSection_V0Hi"><a href="/"><img src="/img/logo-fotter.svg" class="logoFotter_AVem" alt="TDSpora"><img src="/img/tdspora-icon-fotter.svg" class="tdsporaIconFotter_u7ul" alt="TDSpora"></a><div class="linksContainer_itM2"><div class="columnContainer_Zf8D"><div class="title_gHmw">Product</div><ul><li class="link_G08R"><a href="/features">Features</a></li><li class="link_G08R"><a href="/plans">Plans</a></li></ul></div><div class="columnContainer_Zf8D"><div class="title_gHmw">Support</div><ul><li class="link_G08R"><a href="/docs/introduction">Docs</a></li><li class="link_G08R"><a href="/contact">Contact us</a></li><li class="link_G08R"><a href="/docs/faq/faq-data-generation">FAQ</a></li></ul></div><div class="columnContainer_Zf8D"><div class="title_gHmw">Legal</div><ul><li class="link_G08R"><a href="/docs/legal/EULA">License Agreement</a></li><li class="link_G08R"><a href="https://www.epam.com/privacy-policy" target="_blank" rel="noopener noreferrer">Privacy Policy</a></li></ul></div></div></section><section class="flex flex-row gap-y-4 py-5 border-t border-monochrome-medium-tint flex-row justify-between"><span class="flex flex-row gap-y-2 items-center gap-x-2 text-16 leading-24 text-monochrome-text">Sponsored by<a href="https://solutionshub.epam.com/solution/tdspora" target="_blank" rel="noopener noreferrer"><img src="/img/epam-logo.svg" alt="epam systems logo"></a></span><a href="https://github.com/tdspora/tdspora.github.io" target="_blank" rel="noopener noreferrer" class="githubLink_rgoe"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" role="img"><path clip-rule="evenodd" d="M11.999 0C5.373 0 0 5.509 0 12.304 0 17.74 3.438 22.351 8.207 23.98c.6.113.819-.267.819-.594 0-.292-.01-1.066-.017-2.092-3.337.743-4.042-1.65-4.042-1.65-.545-1.421-1.332-1.8-1.332-1.8-1.09-.762.082-.747.082-.747 1.205.087 1.838 1.268 1.838 1.268 1.07 1.88 2.81 1.337 3.493 1.022.109-.795.419-1.337.762-1.644-2.665-.312-5.467-1.367-5.467-6.081 0-1.344.468-2.442 1.236-3.302-.124-.311-.536-1.562.118-3.256 0 0 1.007-.33 3.3 1.26A11.258 11.258 0 0 1 12 5.95a11.27 11.27 0 0 1 3.005.414c2.29-1.592 3.296-1.261 3.296-1.261.655 1.694.243 2.945.12 3.256.77.86 1.233 1.958 1.233 3.302 0 4.726-2.806 5.766-5.478 6.07.43.38.814 1.131.814 2.28 0 1.644-.015 2.97-.015 3.374 0 .33.217.712.825.592 4.765-1.63 8.2-6.238 8.2-11.673C24 5.51 18.627 0 11.999 0z"></path></svg></a></section></div></footer></div>
<script src="/assets/js/runtime~main.9a2d847a.js"></script>
<script src="/assets/js/main.2abae0fa.js"></script>
</body>
</html>